(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d224d23"],{e288:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-list-group",[e._v(" INBOX ( "+e._s(e.messages.length)+" messages ) "),e._l(e.messages,(function(t){return n("b-list-group-item",{key:t.url},[e._v(" "+e._s(t.created)+" / "+e._s(t.creator)+" : "),n("b",[e._v(e._s(t.annonce.title))]),e._v(" ::: "+e._s(t.text)+" "),n("b-button",{staticStyle:{"margin-left":"auto"},attrs:{variant:"light"},on:{click:function(n){return e.reply(t)}}},[n("b-icon",{attrs:{icon:"pen"}})],1),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.message-delete",modifiers:{"message-delete":!0}}],staticStyle:{"margin-left":"auto"},attrs:{variant:"danger"},on:{click:function(n){return e.showDeleteConfirm(t)}}},[n("b-icon",{attrs:{icon:"trash"}})],1)],1)})),n("b-modal",{attrs:{id:"message-delete",centered:"",title:"Delete"},on:{ok:e.onDelete}},[n("div",{staticClass:"p-3",domProps:{innerHTML:e._s(e.deleteMessage)}})])],2)},a=[],s=n("1da1"),o=(n("96cf"),n("00e8")),c=n.n(o),l=n("7fed"),i=n.n(l),u=new i.a(c.a),d=window.solid,g={name:"AnnonceInbox",data:function(){return{messages:[],deleteMessage:""}},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.readInbox();case 1:case"end":return t.stop()}}),t)})))()},methods:{readInbox:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r,a,s,o,c,l,i,g,b,m,f,w;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null==e.webId){t.next=58;break}return t.next=3,d.data.from(e.webId)[e.webId]["http://www.w3.org/ns/ldp#inbox"];case 3:return n=t.sent,r="".concat(n)+"annonces/",t.next=7,u.itemExists(r);case 7:if(t.sent){t.next=10;break}return t.next=10,u.createFolder(r);case 10:return t.next=12,u.aclUrlParser(r);case 12:return a=t.sent,console.log("inherit acl",a),t.next=16,u.acl.createContent(r,a);case 16:return s=t.sent,console.log(s),t.next=20,u.acl.addUserMode({},[{agent:e.webId}],["Read","Write","Control"],["accessTo","default"]);case 20:return o=t.sent,t.next=23,u.acl.addUserMode(o,[{agentClass:"AuthenticatedAgent"}],["Append"],["default"]);case 23:return o=t.sent,t.next=26,u.acl.addUserMode(o,[{agentClass:"Agent"}],["Append","Read"],["accessTo"]);case 26:return o=t.sent,t.next=29,u.acl.createContent(r,o);case 29:return c=t.sent,console.log("build an aclContent "+c),t.next=33,u.getItemLinks(r,{links:"include_possible"});case 33:return l=t.sent,i=l.acl,t.next=37,u.putFile(i,c,"text/turtle");case 37:return g=t.sent,console.log("result",g),t.next=41,u.readFolder(r);case 41:b=t.sent,console.log(b),m=b.files.sort((function(e,t){return new Date(t.created).getTime()-new Date(e.created).getTime()})),e.messages=[];case 45:if(!(m.length>0)){t.next=58;break}return f=m.shift(),t.t0=JSON,t.next=50,u.readFile(f.url);case 50:return t.t1=t.sent,t.next=53,t.t0.parse.call(t.t0,t.t1);case 53:w=t.sent,w.url=f.url,e.messages.push(w),t.next=45;break;case 58:case"end":return t.stop()}}),t)})))()},onDelete:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("delete"),t.next=3,u.deleteFile(e.urlToDelete);case 3:e.readInbox();case 4:case"end":return t.stop()}}),t)})))()},showDeleteConfirm:function(e){this.deleteMessage="Do you want to delete <b>"+e.url+"</b>",this.urlToDelete=e.url}},watch:{webId:function(){this.readInbox()}},computed:{webId:function(){return this.$store.state.solid.webId}}},b=g,m=n("2877"),f=Object(m["a"])(b,r,a,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-2d224d23.c29af8b1.js.map