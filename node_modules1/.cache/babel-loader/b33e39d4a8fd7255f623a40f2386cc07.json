{"remainingRequest":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\Notif.js","dependencies":[{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\Notif.js","mtime":1616523869035},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL1NtYWcvRG9jdW1lbnRzL2Rldi9ib24tcHJpeC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzovVXNlcnMvU21hZy9Eb2N1bWVudHMvZGV2L2Jvbi1wcml4L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQzovVXNlcnMvU21hZy9Eb2N1bWVudHMvZGV2L2Jvbi1wcml4L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKdmFyIGxkZmxleCA9IHdpbmRvdy5zb2xpZDsKaW1wb3J0IGF1dGggZnJvbSAnc29saWQtYXV0aC1jbGllbnQnOwppbXBvcnQgRkMgZnJvbSAnc29saWQtZmlsZS1jbGllbnQnOwp2YXIgZmMgPSBuZXcgRkMoYXV0aCk7Cgp2YXIgX3JlcXVpcmUgPSByZXF1aXJlKCdAcmRmanMvZGF0YS1tb2RlbCcpLAogICAgbmFtZWROb2RlID0gX3JlcXVpcmUubmFtZWROb2RlOwoKZXhwb3J0IHZhciBOb3RpZiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTm90aWYocGF0aCwgYW5ub25jZSkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5vdGlmKTsKCiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7IC8vICAgIHRoaXMucGF0aCA9IFtwYXRoLCBkYXRlLmdldEZ1bGxZZWFyKCksICgiMCIgKyAoZGF0ZS5nZXRNb250aCgpICsgMSkpLnNsaWNlKC0yKSwgKCIwIiArIGRhdGUuZ2V0RGF0ZSgpKS5zbGljZSgtMiksICJhbm5vbmNlcy50dGwiXS5qb2luKCIvIikKCiAgICB0aGlzLnBhdGggPSBbcGF0aCArIGRhdGUuZ2V0RnVsbFllYXIoKSwgKCIwIiArIChkYXRlLmdldE1vbnRoKCkgKyAxKSkuc2xpY2UoLTIpLCAoIjAiICsgZGF0ZS5nZXREYXRlKCkpLnNsaWNlKC0yKSArICIudHRsI3RoaXMiXS5qb2luKCIvIik7CiAgICB0aGlzLmFubm9uY2UgPSBhbm5vbmNlOwogICAgdGhpcy5ub3RpZnkoKTsKICB9CgogIF9jcmVhdGVDbGFzcyhOb3RpZiwgW3sKICAgIGtleTogIm5vdGlmeSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX25vdGlmeSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbGVVcmwoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25ldyBub3RpZicsIHRoaXMpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gbGRmbGV4LmRhdGFbdGhpcy5wYXRoXVsnaHR0cDovL3B1cmwub3JnL2RjL3Rlcm1zL2hhc1BhcnQnXS5hZGQobmFtZWROb2RlKHRoaXMuYW5ub25jZS51cmwpKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIG5vdGlmeSgpIHsKICAgICAgICByZXR1cm4gX25vdGlmeS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gbm90aWZ5OwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZmlsZVVybCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2ZpbGVVcmwgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gZmMuaXRlbUV4aXN0cyh0aGlzLnBhdGgpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBpZiAoX2NvbnRleHQyLnNlbnQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gZmMucG9zdEZpbGUodGhpcy5wYXRoLCAiIiwgInRleHQvdHVydGxlIikudGhlbihmdW5jdGlvbiAoY29udGVudCkgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmlsZSBDcmVhdGVkIiwgY29udGVudCk7CiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zb2xlLmVycm9yKCJFcnJvcjogIi5jb25jYXQoZXJyKSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGaWxlIGV4aXN0IiwgdGhpcy5wYXRoKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZmlsZVVybCgpIHsKICAgICAgICByZXR1cm4gX2ZpbGVVcmwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZpbGVVcmw7CiAgICB9KCkKICB9XSk7CgogIHJldHVybiBOb3RpZjsKfSgpOw=="},{"version":3,"sources":["C:/Users/Smag/Documents/dev/bon-prix/src/components/annonce/Notif.js"],"names":["ldflex","window","solid","auth","FC","fc","require","namedNode","Notif","path","annonce","date","Date","getFullYear","getMonth","slice","getDate","join","notify","fileUrl","console","log","data","add","url","itemExists","postFile","then","content","catch","err","error"],"mappings":";;;;;;AAAA,IAAIA,MAAM,GAAGC,MAAM,CAACC,KAApB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,EAAP,MAAe,mBAAf;AACA,IAAMC,EAAE,GAAG,IAAID,EAAJ,CAAQD,IAAR,CAAX;;eAEsBG,OAAO,CAAC,mBAAD,C;IAArBC,S,YAAAA,S;;AAER,WAAaC,KAAb;AACE,iBAAYC,IAAZ,EAAkBC,OAAlB,EAA0B;AAAA;;AACxB,QAAIC,IAAI,GAAG,IAAIC,IAAJ,EAAX,CADwB,CAGxB;;AACA,SAAKH,IAAL,GAAY,CAACA,IAAI,GAACE,IAAI,CAACE,WAAL,EAAN,EAA0B,CAAC,OAAOF,IAAI,CAACG,QAAL,KAAkB,CAAzB,CAAD,EAA8BC,KAA9B,CAAoC,CAAC,CAArC,CAA1B,EAAmE,CAAC,MAAMJ,IAAI,CAACK,OAAL,EAAP,EAAuBD,KAAvB,CAA6B,CAAC,CAA9B,IAAiC,WAApG,EAAiHE,IAAjH,CAAsH,GAAtH,CAAZ;AACA,SAAKP,OAAL,GAAeA,OAAf;AAEA,SAAKQ,MAAL;AACD;;AATH;AAAA;AAAA;AAAA,4EAWE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACQ,KAAKC,OAAL,EADR;;AAAA;AAEEC,gBAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB,IAAzB;AAFF;AAAA,uBAIQrB,MAAM,CAACsB,IAAP,CAAY,KAAKb,IAAjB,EAAuB,kCAAvB,EAA2Dc,GAA3D,CAA+DhB,SAAS,CAAC,KAAKG,OAAL,CAAac,GAAd,CAAxE,CAJR;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAXF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6EAiBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACanB,EAAE,CAACoB,UAAH,CAAe,KAAKhB,IAApB,CADb;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAMUJ,EAAE,CAACqB,QAAH,CAAY,KAAKjB,IAAjB,EAAuB,EAAvB,EAA2B,aAA3B,EACLkB,IADK,CACA,UAACC,OAAD,EAAa;AACjBR,kBAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA2BO,OAA3B;AACD,iBAHK,EAILC,KAJK,CAIC,UAAAC,GAAG;AAAA,yBAAIV,OAAO,CAACW,KAAR,kBAAwBD,GAAxB,EAAJ;AAAA,iBAJJ,CANV;;AAAA;AAAA;AAAA;;AAAA;AAYIV,gBAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAAyB,KAAKZ,IAA9B;;AAZJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAjBF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA","sourcesContent":["let ldflex = window.solid\r\nimport auth from 'solid-auth-client';\r\nimport FC from 'solid-file-client'\r\nconst fc = new FC( auth )\r\n\r\nconst { namedNode } = require('@rdfjs/data-model');\r\n\r\nexport class Notif {\r\n  constructor(path, annonce){\r\n    let date = new Date()\r\n\r\n    //    this.path = [path, date.getFullYear(), (\"0\" + (date.getMonth() + 1)).slice(-2), (\"0\" + date.getDate()).slice(-2), \"annonces.ttl\"].join(\"/\")\r\n    this.path = [path+date.getFullYear(), (\"0\" + (date.getMonth() + 1)).slice(-2), (\"0\" + date.getDate()).slice(-2)+\".ttl#this\"].join(\"/\")\r\n    this.annonce = annonce\r\n\r\n    this.notify()\r\n  }\r\n\r\n  async notify(){\r\n    await this.fileUrl()\r\n    console.log('new notif', this)\r\n\r\n    await ldflex.data[this.path]['http://purl.org/dc/terms/hasPart'].add(namedNode(this.annonce.url))\r\n  }\r\n  async  fileUrl(){\r\n    if( !await fc.itemExists( this.path )) {\r\n      // REVOIR POUR INSERER LES prefix\r\n      // let baseFileContent = `@prefix : <#>.\r\n      // @prefix terms: <http://purl.org/dc/terms/>.`\r\n      // await fc.postFile(this.path, baseFileContent, \"text/turtle\")\r\n      await fc.postFile(this.path, \"\", \"text/turtle\")\r\n      .then((content) => {\r\n        console.log(\"File Created\",content)\r\n      })\r\n      .catch(err => console.error(`Error: ${err}`))\r\n    }else{\r\n      console.log(\"File exist\",this.path)\r\n    }\r\n  }\r\n\r\n\r\n}\r\n"]}]}