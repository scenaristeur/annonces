{"remainingRequest":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\AnnonceInbox.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\AnnonceInbox.vue","mtime":1616634341536},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL1NtYWcvRG9jdW1lbnRzL2Rldi9ib24tcHJpeC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF1dGggZnJvbSAnc29saWQtYXV0aC1jbGllbnQnOwppbXBvcnQgRkMgZnJvbSAnc29saWQtZmlsZS1jbGllbnQnOwp2YXIgZmMgPSBuZXcgRkMoYXV0aCk7CnZhciBsZGZsZXggPSB3aW5kb3cuc29saWQ7IC8vIGltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBbm5vbmNlSW5ib3giLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtZXNzYWdlczogW10sCiAgICAgIGRlbGV0ZU1lc3NhZ2U6ICIiCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIC8vICB0aGlzLndlYklkID0gdGhpcy4kc3RvcmUuc3RhdGUuc29saWQud2ViSWQKICAgICAgICAgICAgICBfdGhpcy5yZWFkSW5ib3goKTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHJlYWRJbmJveDogZnVuY3Rpb24gcmVhZEluYm94KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBpbmJveEZvbGRlciwgaW5ib3hBbm5vbmNlLCBmb2xkZXIsIGZpbGVzLCBmLCBtOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczIud2ViSWQgIT0gbnVsbCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGxkZmxleC5kYXRhLmZyb20oX3RoaXMyLndlYklkKVtfdGhpczIud2ViSWRdWydodHRwOi8vd3d3LnczLm9yZy9ucy9sZHAjaW5ib3gnXTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgaW5ib3hGb2xkZXIgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIGluYm94QW5ub25jZSA9ICIiLmNvbmNhdChpbmJveEZvbGRlcikgKyAiYW5ub25jZXMvIjsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBmYy5yZWFkRm9sZGVyKGluYm94QW5ub25jZSk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGZvbGRlciA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZm9sZGVyKTsKICAgICAgICAgICAgICAgIGZpbGVzID0gZm9sZGVyLmZpbGVzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGIuY3JlYXRlZCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5jcmVhdGVkKS5nZXRUaW1lKCk7CiAgICAgICAgICAgICAgICB9KTsgLy8gY29uc29sZS5sb2coZmlsZXMpCgogICAgICAgICAgICAgICAgX3RoaXMyLm1lc3NhZ2VzID0gW107IC8vCgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBpZiAoIShmaWxlcy5sZW5ndGggPiAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmID0gZmlsZXMuc2hpZnQoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IEpTT047CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgcmV0dXJuIGZjLnJlYWRGaWxlKGYudXJsKTsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MSA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxOTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIudDAucGFyc2UuY2FsbChfY29udGV4dDIudDAsIF9jb250ZXh0Mi50MSk7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICBtID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBtLnVybCA9IGYudXJsOwoKICAgICAgICAgICAgICAgIF90aGlzMi5tZXNzYWdlcy5wdXNoKG0pOyAvLyAgY29uc29sZS5sb2codGhpcy5tZXNzYWdlcykKICAgICAgICAgICAgICAgIC8vICBjb25zb2xlLmxvZyhmKQogICAgICAgICAgICAgICAgLy8gbGV0IHJlc291cmNlID0gZi51cmwrIiN0aGlzIgogICAgICAgICAgICAgICAgLy8gZm9yIGF3YWl0IChjb25zdCBhbm5vbmNlX3VybCBvZiBsZGZsZXguZGF0YVtyZXNvdXJjZV1bJ2h0dHA6Ly9wdXJsLm9yZy9kYy90ZXJtcy9oYXNQYXJ0J10pewogICAgICAgICAgICAgICAgLy8gICBsZXQgaWR4ID0gdGhpcy5hbm5vbmNlcy5maW5kSW5kZXgoeCA9PiB4LnVybCA9PT0gYCR7YW5ub25jZV91cmx9YCkKICAgICAgICAgICAgICAgIC8vICAgaWYgKGlkeCA9PT0gLTEpIHsKICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLmFubm9uY2VzLnB1c2goe3VybDogYCR7YW5ub25jZV91cmx9YH0pCiAgICAgICAgICAgICAgICAvLyAgIH0KICAgICAgICAgICAgICAgIC8vIH0KCgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgb25EZWxldGU6IGZ1bmN0aW9uIG9uRGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZGVsZXRlIik7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gZmMuZGVsZXRlRmlsZShfdGhpczMudXJsVG9EZWxldGUpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfdGhpczMucmVhZEluYm94KCk7IC8vdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2Fubm9uY2UvZGVsZXRlJywgdGhpcy5pZFRvRGVsZXRlKQoKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2hvd0RlbGV0ZUNvbmZpcm06IGZ1bmN0aW9uIHNob3dEZWxldGVDb25maXJtKG0pIHsKICAgICAgdGhpcy5kZWxldGVNZXNzYWdlID0gIkRvIHlvdSB3YW50IHRvIGRlbGV0ZSA8Yj4iICsgbS51cmwgKyAiPC9iPiI7CiAgICAgIHRoaXMudXJsVG9EZWxldGUgPSBtLnVybDsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICB3ZWJJZDogZnVuY3Rpb24gd2ViSWQoKSB7CiAgICAgIHRoaXMucmVhZEluYm94KCk7CiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgd2ViSWQ6IGZ1bmN0aW9uIHdlYklkKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuc29saWQud2ViSWQ7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["AnnonceInbox.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <b-list-group>\r\n    INBOX ( {{ messages.length}} messages )\r\n    <b-list-group-item v-for=\"m in messages\" :key=\"m.url\">\r\n      {{ m.created }} / {{ m.creator}} : <b>{{m.annonce.title}}</b> ::: {{ m.text }}\r\n\r\n\r\n      <b-button variant=\"light\" @click=\"reply(m)\" style=\"margin-left:auto;\">\r\n        <b-icon icon=\"pen\"></b-icon>\r\n      </b-button>\r\n      <b-button variant=\"danger\" @click=\"showDeleteConfirm(m)\" style=\"margin-left:auto;\" v-b-modal.message-delete>\r\n        <b-icon icon=\"trash\"></b-icon>\r\n      </b-button>\r\n    </b-list-group-item>\r\n\r\n    <b-modal id=\"message-delete\" centered title=\"Delete\" @ok=\"onDelete\">\r\n      <div class=\"p-3\" v-html=\"deleteMessage\"></div>\r\n    </b-modal>\r\n\r\n  </b-list-group>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\nimport auth from 'solid-auth-client';\r\nimport FC from 'solid-file-client'\r\nconst fc = new FC( auth )\r\nlet ldflex = window.solid\r\n// import { v4 as uuidv4 } from 'uuid';\r\n\r\nexport default {\r\n  name: \"AnnonceInbox\",\r\n  data() {\r\n    return {\r\n      messages: [],\r\n      deleteMessage: \"\"\r\n    }\r\n  },\r\n  async created(){\r\n    //  this.webId = this.$store.state.solid.webId\r\n    this.readInbox()\r\n  },\r\n  methods: {\r\n    async readInbox() {\r\n      if (this.webId != null){\r\n        let inboxFolder = await ldflex.data.from(this.webId)[this.webId]['http://www.w3.org/ns/ldp#inbox']\r\n        let inboxAnnonce = `${inboxFolder}`+\"annonces/\"\r\n        let folder = await fc.readFolder(inboxAnnonce)\r\n        console.log(folder)\r\n        let files = folder.files.sort((a,b) => new Date(b.created).getTime() - new Date(a.created).getTime());\r\n        // console.log(files)\r\n        this.messages = []\r\n        //\r\n        while ( files.length > 0){\r\n          let f = files.shift()\r\n          let m = await JSON.parse(await fc.readFile(f.url))\r\n          m.url = f.url\r\n          this.messages.push(m)\r\n          //  console.log(this.messages)\r\n          //  console.log(f)\r\n          // let resource = f.url+\"#this\"\r\n          // for await (const annonce_url of ldflex.data[resource]['http://purl.org/dc/terms/hasPart']){\r\n          //   let idx = this.annonces.findIndex(x => x.url === `${annonce_url}`)\r\n          //   if (idx === -1) {\r\n          //     this.annonces.push({url: `${annonce_url}`})\r\n          //   }\r\n          // }\r\n        }\r\n      }\r\n    },\r\n    async onDelete(){\r\n      console.log(\"delete\")\r\n      await fc.deleteFile(this.urlToDelete)\r\n      this.readInbox()\r\n      //this.$store.dispatch('annonce/delete', this.idToDelete)\r\n    },\r\n    showDeleteConfirm(m){\r\n      this.deleteMessage= \"Do you want to delete <b>\"+m.url+\"</b>\"\r\n      this.urlToDelete = m.url\r\n    },\r\n  },\r\n  watch:{\r\n    webId(){\r\n      this.readInbox()\r\n    }\r\n  },\r\n  computed:{\r\n    webId() {\r\n      return this.$store.state.solid.webId\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n"],"sourceRoot":"src/components/annonce"}]}