{"remainingRequest":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\AnnonceDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\AnnonceDetail.vue","mtime":1616635029528},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXV0aCBmcm9tICdzb2xpZC1hdXRoLWNsaWVudCc7DQppbXBvcnQgRkMgZnJvbSAnc29saWQtZmlsZS1jbGllbnQnDQpjb25zdCBmYyA9IG5ldyBGQyggYXV0aCApDQpsZXQgbGRmbGV4ID0gd2luZG93LnNvbGlkDQppbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJzsNCg0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJBbm5vbmNlRGV0YWlsIiwNCiAgZGF0YSgpew0KICAgIHJldHVybiB7DQogICAgICBhOiB7fSwNCiAgICAgIG1lc3NhZ2U6IHt9LA0KICAgICAgZXJyb3IgOiAiIg0KICAgIH0NCiAgfSwNCiAgYXN5bmMgY3JlYXRlZCgpew0KICAgIGxldCB1cmwgPSB0aGlzLiRyb3V0ZS5xdWVyeS51cmwNCiAgICBjb25zb2xlLmxvZyh1cmwpDQogICAgaWYgKHVybCA9PSB1bmRlZmluZWQpeyB0aGlzLiRyb3V0ZXIucHVzaCh7cGF0aDogJy8nfSkgfWVsc2V7DQogICAgICB0cnl7DQogICAgICAgIHRoaXMuYSA9IEpTT04ucGFyc2UoYXdhaXQgZmMucmVhZEZpbGUodXJsKSkNCiAgICAgICAgdGhpcy5hLmltYWdlID0gdGhpcy5hLmltYWdlc1swXSB8fCAiaHR0cHM6Ly9waWNzdW0ucGhvdG9zLzQwMC8yMDAvP2ltYWdlPTQxIg0KICAgICAgICB0aGlzLmEuZGF0ZSA9IHRoaXMuYS5tb2RpZmllZC5wb3AoKSB8fCB0aGlzLmEuY3JlYXRlZA0KICAgICAgICBsZXQgaW5ib3hGb2xkZXIgPSBhd2FpdCBsZGZsZXguZGF0YS5mcm9tKHRoaXMuYS5jcmVhdG9yKVt0aGlzLmEuY3JlYXRvcl1bJ2h0dHA6Ly93d3cudzMub3JnL25zL2xkcCNpbmJveCddDQogICAgICAgIHRoaXMuaW5ib3hBbm5vbmNlID0gYCR7aW5ib3hGb2xkZXJ9YCsiYW5ub25jZXMvIg0KICAgICAgfWNhdGNoKGUpew0KICAgICAgICB0aGlzLmVycm9yID0gZSsgIi4uLiBcbiBUaGVyZSBpcyBubyBhbm5vbmNlIGF0IFxuIit1cmwNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBvblNlbmQoKSB7DQogICAgICB0aGlzLm1lc3NhZ2UuYW5ub25jZSA9IHRoaXMuYQ0KICAgICAgdGhpcy5tZXNzYWdlLmNyZWF0b3IgPSB0aGlzLndlYklkDQogICAgICB0aGlzLm1lc3NhZ2UuY3JlYXRlZCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKQ0KICAgICAgY29uc29sZS5sb2codGhpcy5tZXNzYWdlKQ0KICAgICAgY29uc29sZS5sb2codGhpcy5pbmJveEFubm9uY2UpDQogICAgICBsZXQgZmlsZSA9IHRoaXMuaW5ib3hBbm5vbmNlK3V1aWR2NCgpKyIuanNvbiINCiAgICAgIHRyeXsNCiAgICAgICAgYXdhaXQgZmMuY3JlYXRlRmlsZShmaWxlLCBKU09OLnN0cmluZ2lmeSh0aGlzLm1lc3NhZ2UpLCAiYXBwbGljYXRpb24vanNvbiIpDQogICAgICAgIGFsZXJ0KCJNZXNzYWdlIHNlbmQgdG8gIit0aGlzLm1lc3NhZ2UuYW5ub25jZS5jcmVhdG9yKQ0KICAgICAgfWNhdGNoKGUpew0KICAgICAgICBhbGVydCgiU29ycnkgYnV0IGkgY2FuIG5vdCBzZW5kIG1lc3NhZ2UsICIrZSkNCiAgICAgIH0NCiAgICAgIHRoaXMubWVzc2FnZS50ZXh0ID0gIiINCg0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6ew0KICAgIHdlYklkKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnNvbGlkLndlYklkDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["AnnonceDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AnnonceDetail.vue","sourceRoot":"src/components/annonce","sourcesContent":["<template>\r\n  <div>\r\n\r\n    <b-card\r\n    tag=\"article\"\r\n    class=\"mb-2\"\r\n    button\r\n    >\r\n\r\n    <b-card-title class=\"d-flex justify-content-between align-items-center\">\r\n\r\n      <span>{{a.title}}</span>\r\n      <b-badge variant=\"primary\" pill class=\"mr-3\">{{a.category}}</b-badge>\r\n      <b-card-text>\r\n        {{a.price}} {{a.currency}}\r\n\r\n      </b-card-text>\r\n    </b-card-title>\r\n\r\n\r\n    <b-card-text>\r\n      {{ a.description }}\r\n    </b-card-text>\r\n\r\n\r\n    <b-alert v-if=\"error.length == 0\" show>\r\n      <div v-if=\"webId != null\">\r\n        Contact : <b-button v-b-modal.modal-contact variant=\"info\">{{ a.creator }}</b-button>\r\n      </div>\r\n      <div v-else>\r\n        You must login to contact the creator of this annonce.\r\n      </div>\r\n    </b-alert>\r\n    <b-alert v-else show variant=\"danger\">\r\n      {{ error }}\r\n\r\n      <b-button variant=\"danger\" to=\"/\">Back to Annonces List</b-button>\r\n    </b-alert>\r\n\r\n    <div v-for=\"i in a.images\" :key=\"i\">\r\n      <b-card-img :src=\"i\" alt=\"Image\"   style=\"max-width: 20rem;\"\r\n      class=\"mb-2\" bottom></b-card-img>\r\n    </div>\r\n    <!-- {{ a.images }} -->\r\n\r\n\r\n\r\n    <small> modified: {{a.date}}</small>\r\n  </b-card>\r\n\r\n\r\n  <b-modal id=\"modal-contact\" centered title=\"Send a message\" @ok=\"onSend\" size=\"lg\">\r\n\r\n    <b-form-textarea\r\n    id=\"textarea\"\r\n    v-model=\"message.text\"\r\n    :placeholder=\"'Enter your message to '+ a.creator\"\r\n    rows=\"3\"\r\n    max-rows=\"6\"\r\n    ></b-form-textarea>\r\n  </b-modal>\r\n\r\n</div>\r\n\r\n<!-- <b-button variant=\"outline-info\"> -->\r\n<!-- </b-button>\r\n{{ a}}\r\n</div> -->\r\n</template>\r\n\r\n<script>\r\nimport auth from 'solid-auth-client';\r\nimport FC from 'solid-file-client'\r\nconst fc = new FC( auth )\r\nlet ldflex = window.solid\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\n\r\nexport default {\r\n  name: \"AnnonceDetail\",\r\n  data(){\r\n    return {\r\n      a: {},\r\n      message: {},\r\n      error : \"\"\r\n    }\r\n  },\r\n  async created(){\r\n    let url = this.$route.query.url\r\n    console.log(url)\r\n    if (url == undefined){ this.$router.push({path: '/'}) }else{\r\n      try{\r\n        this.a = JSON.parse(await fc.readFile(url))\r\n        this.a.image = this.a.images[0] || \"https://picsum.photos/400/200/?image=41\"\r\n        this.a.date = this.a.modified.pop() || this.a.created\r\n        let inboxFolder = await ldflex.data.from(this.a.creator)[this.a.creator]['http://www.w3.org/ns/ldp#inbox']\r\n        this.inboxAnnonce = `${inboxFolder}`+\"annonces/\"\r\n      }catch(e){\r\n        this.error = e+ \"... \\n There is no annonce at \\n\"+url\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async onSend() {\r\n      this.message.annonce = this.a\r\n      this.message.creator = this.webId\r\n      this.message.created = new Date().toISOString()\r\n      console.log(this.message)\r\n      console.log(this.inboxAnnonce)\r\n      let file = this.inboxAnnonce+uuidv4()+\".json\"\r\n      try{\r\n        await fc.createFile(file, JSON.stringify(this.message), \"application/json\")\r\n        alert(\"Message send to \"+this.message.annonce.creator)\r\n      }catch(e){\r\n        alert(\"Sorry but i can not send message, \"+e)\r\n      }\r\n      this.message.text = \"\"\r\n\r\n    }\r\n  },\r\n  computed:{\r\n    webId() {\r\n      return this.$store.state.solid.webId\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n"]}]}