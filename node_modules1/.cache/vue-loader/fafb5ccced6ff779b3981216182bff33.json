{"remainingRequest":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\AnnonceAgora.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\AnnonceAgora.vue","mtime":1616621565956},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5jb21wb25lbnQtZmFkZS1lbnRlci1hY3RpdmUsIC5jb21wb25lbnQtZmFkZS1sZWF2ZS1hY3RpdmUgew0KICB0cmFuc2l0aW9uOiBvcGFjaXR5IC4zcyBlYXNlOw0KfQ0KLmNvbXBvbmVudC1mYWRlLWVudGVyLCAuY29tcG9uZW50LWZhZGUtbGVhdmUtdG8NCi8qIC5jb21wb25lbnQtZmFkZS1sZWF2ZS1hY3RpdmUgYmVsb3cgdmVyc2lvbiAyLjEuOCAqLyB7DQogIG9wYWNpdHk6IDA7DQp9DQo="},{"version":3,"sources":["AnnonceAgora.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2HA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AnnonceAgora.vue","sourceRoot":"src/components/annonce","sourcesContent":["<template>\r\n  <div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    <b-input-group class=\"mt-3\">\r\n      <b-input v-model=\"temp_url\" />\r\n      <b-input-group-append>\r\n        <b-button variant=\"outline-success\" @click=\"load\">Load</b-button>\r\n\r\n      </b-input-group-append>\r\n    </b-input-group>\r\n    Agora's Annonces\r\n\r\n    <b-card-group columns>\r\n      <AnnonceCard :annonce=\"a\" v-for=\"a in annonces\" :key=\"a.url\" />\r\n\r\n      <transition name=\"component-fade\" mode=\"out-in\">\r\n        <component v-bind:is=\"view\"></component>\r\n      </transition>\r\n\r\n    </b-card-group>\r\n\r\n\r\n    <!-- <b-list-group>\r\n    <b-list-group-item button v-for=\"a in annonces\" :key=\"a.url\">\r\n    <AnnonceLine :annonce=\"a\" />\r\n  </b-list-group-item>\r\n\r\n\r\n</b-list-group> -->\r\n\r\n</div>\r\n</template>\r\n\r\n<script>\r\n\r\n\r\nimport auth from 'solid-auth-client';\r\nimport FC from 'solid-file-client'\r\nconst fc = new FC( auth )\r\nlet ldflex = window.solid\r\n\r\nexport default {\r\n  name: \"AnnonceAgora\",\r\n  components: {\r\n    'AnnonceCard': () => import('@/components/annonce/AnnonceCard'),\r\n    'AnnonceDetail': () => import('@/components/annonce/AnnonceDetail'),\r\n //    'v-a': {\r\n //   template: '<div>Component A</div>'\r\n // },\r\n // 'v-b': {\r\n //   template: '<div>Component B</div>'\r\n // }\r\n  },\r\n  data(){\r\n    return {\r\n      temp_url: this.$store.state.annonce.agora_url,\r\n      annonces : [],\r\n      view: 'AnnonceCard'\r\n    }\r\n  },\r\n  created(){\r\n    this.load()\r\n  },\r\n  methods: {\r\n    async  load() {\r\n      this.agora_url = this.temp_url\r\n      let date = new Date()\r\n      let path = [this.agora_url+date.getFullYear(), (\"0\" + (date.getMonth() + 1)).slice(-2)].join(\"/\")\r\n      let folder = await fc.readFolder(path)\r\n      console.log(folder)\r\n      let files = folder.files.sort((a,b) => new Date(b.modified).getTime() - new Date(a.modified).getTime());\r\n      console.log(files)\r\n      this.annonces = []\r\n\r\n      while (this.annonces.length < 100 && files.length > 0){\r\n        let f = files.shift()\r\n        console.log(f)\r\n        let resource = f.url+\"#this\"\r\n        for await (const annonce_url of ldflex.data[resource]['http://purl.org/dc/terms/hasPart']){\r\n          let idx = this.annonces.findIndex(x => x.url === `${annonce_url}`)\r\n          if (idx === -1) {\r\n            this.annonces.push({url: `${annonce_url}`})\r\n          }\r\n        }\r\n      }\r\n\r\n      // for await (const f of folder.files) {\r\n      //   annonces.push(JSON.parse(await fc.readFile(f.url)))\r\n      // }\r\n      //  await folder.files.map( function(x) {\r\n      //   let f =  fc.readFile(x.url)\r\n      //   return `${f}`\r\n      // })\r\n      console.log(this.annonces)\r\n    }\r\n  },\r\n\r\n  watch:{\r\n    agora_url(){\r\n      console.log(this.agora_url)\r\n      this.temp_url = this.agora_url\r\n\r\n    }\r\n  },\r\n\r\n  computed:{\r\n    agora_url: {\r\n      get () { return this.$store.state.annonce.agora_url},\r\n      set (url) { this.$store.commit('annonce/setAgoraUrl', url) }\r\n    }\r\n\r\n  },\r\n\r\n}\r\n</script>\r\n\r\n<style>\r\n.component-fade-enter-active, .component-fade-leave-active {\r\n  transition: opacity .3s ease;\r\n}\r\n.component-fade-enter, .component-fade-leave-to\r\n/* .component-fade-leave-active below version 2.1.8 */ {\r\n  opacity: 0;\r\n}\r\n</style>\r\n"]}]}