{"remainingRequest":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\AnnonceAgora.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\src\\components\\annonce\\AnnonceAgora.vue","mtime":1616627073723},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Smag\\Documents\\dev\\bon-prix\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCg0KaW1wb3J0IGF1dGggZnJvbSAnc29saWQtYXV0aC1jbGllbnQnOw0KaW1wb3J0IEZDIGZyb20gJ3NvbGlkLWZpbGUtY2xpZW50Jw0KY29uc3QgZmMgPSBuZXcgRkMoIGF1dGggKQ0KbGV0IGxkZmxleCA9IHdpbmRvdy5zb2xpZA0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJBbm5vbmNlQWdvcmEiLA0KICBjb21wb25lbnRzOiB7DQogICAgJ0Fubm9uY2VDYXJkJzogKCkgPT4gaW1wb3J0KCdAL2NvbXBvbmVudHMvYW5ub25jZS9Bbm5vbmNlQ2FyZCcpLA0KICB9LA0KICBkYXRhKCl7DQogICAgcmV0dXJuIHsNCiAgICAgIHRlbXBfdXJsOiB0aGlzLiRzdG9yZS5zdGF0ZS5hbm5vbmNlLmFnb3JhX3VybCwNCiAgICAgIGFubm9uY2VzIDogW10NCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKXsNCiAgICB0aGlzLmxvYWQoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgYXN5bmMgIGxvYWQoKSB7DQogICAgICB0aGlzLmFnb3JhX3VybCA9IHRoaXMudGVtcF91cmwNCiAgICAgIGxldCBkYXRlID0gbmV3IERhdGUoKQ0KICAgICAgbGV0IHBhdGggPSBbdGhpcy5hZ29yYV91cmwrZGF0ZS5nZXRGdWxsWWVhcigpLCAoIjAiICsgKGRhdGUuZ2V0TW9udGgoKSArIDEpKS5zbGljZSgtMildLmpvaW4oIi8iKQ0KICAgICAgbGV0IGZvbGRlciA9IGF3YWl0IGZjLnJlYWRGb2xkZXIocGF0aCkNCiAgICAgIGNvbnNvbGUubG9nKGZvbGRlcikNCiAgICAgIGxldCBmaWxlcyA9IGZvbGRlci5maWxlcy5zb3J0KChhLGIpID0+IG5ldyBEYXRlKGIubW9kaWZpZWQpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEubW9kaWZpZWQpLmdldFRpbWUoKSk7DQogICAgICBjb25zb2xlLmxvZyhmaWxlcykNCiAgICAgIHRoaXMuYW5ub25jZXMgPSBbXQ0KDQogICAgICB3aGlsZSAodGhpcy5hbm5vbmNlcy5sZW5ndGggPCAxMDAgJiYgZmlsZXMubGVuZ3RoID4gMCl7DQogICAgICAgIGxldCBmID0gZmlsZXMuc2hpZnQoKQ0KICAgICAgLy8gIGNvbnNvbGUubG9nKGYpDQogICAgICAgIGxldCByZXNvdXJjZSA9IGYudXJsKyIjdGhpcyINCiAgICAgICAgZm9yIGF3YWl0IChjb25zdCBhbm5vbmNlX3VybCBvZiBsZGZsZXguZGF0YVtyZXNvdXJjZV1bJ2h0dHA6Ly9wdXJsLm9yZy9kYy90ZXJtcy9oYXNQYXJ0J10pew0KICAgICAgICAgIGxldCBpZHggPSB0aGlzLmFubm9uY2VzLmZpbmRJbmRleCh4ID0+IHgudXJsID09PSBgJHthbm5vbmNlX3VybH1gKQ0KICAgICAgICAgIGlmIChpZHggPT09IC0xKSB7DQogICAgICAgICAgICB0aGlzLmFubm9uY2VzLnB1c2goe3VybDogYCR7YW5ub25jZV91cmx9YH0pDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIC8vIGZvciBhd2FpdCAoY29uc3QgZiBvZiBmb2xkZXIuZmlsZXMpIHsNCiAgICAgIC8vICAgYW5ub25jZXMucHVzaChKU09OLnBhcnNlKGF3YWl0IGZjLnJlYWRGaWxlKGYudXJsKSkpDQogICAgICAvLyB9DQogICAgICAvLyAgYXdhaXQgZm9sZGVyLmZpbGVzLm1hcCggZnVuY3Rpb24oeCkgew0KICAgICAgLy8gICBsZXQgZiA9ICBmYy5yZWFkRmlsZSh4LnVybCkNCiAgICAgIC8vICAgcmV0dXJuIGAke2Z9YA0KICAgICAgLy8gfSkNCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuYW5ub25jZXMpDQogICAgfQ0KICB9LA0KDQogIHdhdGNoOnsNCiAgICBhZ29yYV91cmwoKXsNCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuYWdvcmFfdXJsKQ0KICAgICAgdGhpcy50ZW1wX3VybCA9IHRoaXMuYWdvcmFfdXJsDQoNCiAgICB9DQogIH0sDQoNCiAgY29tcHV0ZWQ6ew0KICAgIGFnb3JhX3VybDogew0KICAgICAgZ2V0ICgpIHsgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmFubm9uY2UuYWdvcmFfdXJsfSwNCiAgICAgIHNldCAodXJsKSB7IHRoaXMuJHN0b3JlLmNvbW1pdCgnYW5ub25jZS9zZXRBZ29yYVVybCcsIHVybCkgfQ0KICAgIH0NCg0KICB9LA0KDQp9DQo="},{"version":3,"sources":["AnnonceAgora.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"AnnonceAgora.vue","sourceRoot":"src/components/annonce","sourcesContent":["<template>\r\n  <div>\r\n\r\n    <b-input-group class=\"mt-3\">\r\n      <b-input v-model=\"temp_url\" />\r\n      <b-input-group-append>\r\n        <b-button variant=\"outline-success\" @click=\"load\">Load</b-button>\r\n\r\n      </b-input-group-append>\r\n    </b-input-group>\r\n    Agora's Annonces\r\n\r\n    <b-card-group columns>\r\n      <AnnonceCard :annonce=\"a\" v-for=\"a in annonces\" :key=\"a.url\" />\r\n\r\n    </b-card-group>\r\n\r\n\r\n    <!-- <b-list-group>\r\n    <b-list-group-item button v-for=\"a in annonces\" :key=\"a.url\">\r\n    <AnnonceLine :annonce=\"a\" />\r\n  </b-list-group-item>\r\n\r\n\r\n</b-list-group> -->\r\n\r\n</div>\r\n</template>\r\n\r\n<script>\r\n\r\n\r\nimport auth from 'solid-auth-client';\r\nimport FC from 'solid-file-client'\r\nconst fc = new FC( auth )\r\nlet ldflex = window.solid\r\n\r\nexport default {\r\n  name: \"AnnonceAgora\",\r\n  components: {\r\n    'AnnonceCard': () => import('@/components/annonce/AnnonceCard'),\r\n  },\r\n  data(){\r\n    return {\r\n      temp_url: this.$store.state.annonce.agora_url,\r\n      annonces : []\r\n    }\r\n  },\r\n  created(){\r\n    this.load()\r\n  },\r\n  methods: {\r\n    async  load() {\r\n      this.agora_url = this.temp_url\r\n      let date = new Date()\r\n      let path = [this.agora_url+date.getFullYear(), (\"0\" + (date.getMonth() + 1)).slice(-2)].join(\"/\")\r\n      let folder = await fc.readFolder(path)\r\n      console.log(folder)\r\n      let files = folder.files.sort((a,b) => new Date(b.modified).getTime() - new Date(a.modified).getTime());\r\n      console.log(files)\r\n      this.annonces = []\r\n\r\n      while (this.annonces.length < 100 && files.length > 0){\r\n        let f = files.shift()\r\n      //  console.log(f)\r\n        let resource = f.url+\"#this\"\r\n        for await (const annonce_url of ldflex.data[resource]['http://purl.org/dc/terms/hasPart']){\r\n          let idx = this.annonces.findIndex(x => x.url === `${annonce_url}`)\r\n          if (idx === -1) {\r\n            this.annonces.push({url: `${annonce_url}`})\r\n          }\r\n        }\r\n      }\r\n\r\n      // for await (const f of folder.files) {\r\n      //   annonces.push(JSON.parse(await fc.readFile(f.url)))\r\n      // }\r\n      //  await folder.files.map( function(x) {\r\n      //   let f =  fc.readFile(x.url)\r\n      //   return `${f}`\r\n      // })\r\n      console.log(this.annonces)\r\n    }\r\n  },\r\n\r\n  watch:{\r\n    agora_url(){\r\n      console.log(this.agora_url)\r\n      this.temp_url = this.agora_url\r\n\r\n    }\r\n  },\r\n\r\n  computed:{\r\n    agora_url: {\r\n      get () { return this.$store.state.annonce.agora_url},\r\n      set (url) { this.$store.commit('annonce/setAgoraUrl', url) }\r\n    }\r\n\r\n  },\r\n\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n"]}]}